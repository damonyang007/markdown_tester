![0_0.png](0_0.png)

图 13 PSO 流程图

PSO 中每次迭代粒子 i 的速度 $v_i$ 和位置 $x_i$ 更新公式为:
$$
v_i^k = wv_i^{k-1} + c_1 r_1 * rand() * (pbest_i - x_i^{k-1}) + c_2 r_2 * rand() * (gbest - x_i^{k-1})
$$
$$
x_i^k = x_i^{k-1} + v_i^k
$$

![0_1.png](0_1.png)

惯性权重 (inertia weight) 、$c_1$ 和 $c_2$ 为加速常数 (acceleration constants) ，rand() 为在 [0,1] 范围里变化的随机值，$pbest$ 为粒子自身的最佳位置，$gbest$ 为整个群体运行的最佳位置。

采用粒子群算法优化随机森林模型的参数, 可以将模型返回预测结果计算得到的 F1 值作为目标函数，通过多粒子迭代得到最佳位置，即最优参数。

本项目中， 在采用粒子群算法的基础上，还引入了惯性权重线性递减和多样性维护参数的概念，对算法加以改进。其中惯性权重 w 线性递减，根据迭代进度，逐渐减小惯性权重，可以在一定程度上优化寻优后的平滑能力;多样性维护参数 $c_3$ 可以确保种群中的粒子保持一定的多样性，避免陷入局部最优解。

$$
w = w_{max} - \left( \frac{t}{T} \right) (w_{max} - w_{min})
$$

$$
V = c_3 * (Rand() - 0.5) * range
$$

$$
v_i^k = v_i^k + V
$$

其中，$w_{max} = 0.9$，$w_{min} = 0.4$，t 为当前迭代次数，T 为最大迭代次数，$c_3 = 0.1$，V 为多样性维护项，range 为参数获取值范围长度。